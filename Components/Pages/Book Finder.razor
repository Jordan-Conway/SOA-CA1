@page "/BookFinder"
@using CA2.Code
@using CA2.Components

<h3>Component</h3>

<button @onclick="MakeBookRequest">Make book request</button>

<CascadingValue Value="videoTags" Name="VideoTagsValue">
	<CA2.Components.Layout.VideoFinder OnTagsChanged="@OnTagsChanged"></CA2.Components.Layout.VideoFinder>
</CascadingValue>

<CascadingValue Value="selectedTag" Name="SelectedTag">
	<CA2.Components.Layout.TagList Tags="videoTags" OnSelectedTagChanged="@OnSelectedTagChanged"></CA2.Components.Layout.TagList>
</CascadingValue>

<CA2.Components.Layout.BookList></CA2.Components.Layout.BookList>

@code {
	BookService bookService = new();
	string[]? videoTags;
	string? selectedTag;

	public void MakeBookRequest()
	{
		Console.WriteLine("Making request");
		var response = bookService.getBooks("Cooking");
		Console.WriteLine(response.Content);
	}

	public void Print(string input)
	{
		Console.WriteLine(input);
	}

	private void OnTagsChanged(string[] tags)
	{
		videoTags = tags;
		foreach(string tag in tags)
		{
			Console.WriteLine(tag);
		}
	}

	private void OnSelectedTagChanged(Data data)
	{
		selectedTag = data.SelectedTag;
		//The content of videoTags will be lost, so it needs to be set again here
		videoTags = data.Tags;
		Console.WriteLine($"Selected Tag is now: {data.SelectedTag}");
	}
}
